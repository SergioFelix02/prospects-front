<div class="container">
  &nbsp;
  <!-- Nav tabs -->
  <div class="d-flex justify-content-between align-items-center">
    <ul class="nav nav-tabs" role="tablist">
      <li class="nav-item" role="presentation">
        <a class="nav-link" [ngClass]="{'active': activeTab === 1}" (click)="setActiveTab(1)" role="tab">Listado</a>
      </li>
      <li class="nav-item" role="presentation">
        <a class="nav-link" [ngClass]="{'active': activeTab === 2}" (click)="setActiveTab(2)" role="tab">Evaluación</a>
      </li>
    </ul>

    <!-- Botón Nuevo Prospecto -->
    <button class="btn btn-success" (click)="createProspect()">
      <i class="fas fa-plus"></i> Nuevo Prospecto
    </button>
  </div>

  <!-- Tab content -->
  <div class="tab-content">
      &nbsp;
      <!-- Contenido de la pestaña Listado -->
      <div class="tab-pane fade" [ngClass]="{'show active': activeTab === 1}">
          <div class="row align-items-center">
              <div class="col-md-6">
                  <div class="mb-3">
                      <h4 class="card-title">Listado de Prospectos <span class="text-muted fw-normal ms-2"></span></h4>
                  </div>
              </div>
          </div>
          <hr>
          <!-- Tabla de prospectos -->
          <div class="row">
              <div class="col-lg-12">
                  <div class="table-responsive">
                      <table class="table project-list-table table-nowrap align-middle table-borderless table-hover">
                          <thead>
                              <tr>
                                  <th scope="col">Nombre</th>
                                  <th scope="col">Primer Apellido</th>
                                  <th scope="col">Segundo Apellido</th>
                                  <th scope="col">Estatus</th>
                                  <th scope="col" style="width: 200px;">Acciones</th>
                              </tr>
                          </thead>
                          <tbody>
                              <tr *ngFor="let prospect of prospects">
                                <td>{{prospect?.name}}</td>
                                <td>{{prospect?.lastName}}</td>
                                <td>{{prospect?.secondLastName}}</td>
                                <td>
                                  <span
                                      class="badge"
                                      [ngClass]="{
                                          'badge-soft-success': prospect?.status == 1,
                                          'badge-soft-danger': prospect?.status == 2,
                                          'badge-soft-primary': prospect?.status == 3
                                      }">
                                      {{getStatusString(prospect?.status)}}
                                  </span>
                                </td>
                                <td>
                                  <ul class="list-inline mb-0">
                                      <li class="list-inline-item">
                                          <button (click)="editProspect(prospect?.idProspect)" data-bs-toggle="tooltip" data-bs-placement="top" title="view" class="btn btn-sm btn-primary">
                                              <i class="fas fa-eye font-size-18"></i>
                                          </button>
                                      </li>
                                  </ul>
                                </td>
                            </tr>
                          </tbody>
                      </table>
                  </div>
              </div>
          </div>

          <!-- Paginación -->
          <div class="row g-0 align-items-center pb-4">
              <!-- <div class="col-sm-6">
                  <div>
                      <p class="mb-sm-0">{{(page - 1) * pageSize + 1}} - {{page * pageSize > total ? total : page * pageSize}} de {{total}}</p>
                  </div>
              </div> -->
              <div class="col-sm-6">
                  <div class="float-sm-end">
                      <ul class="pagination mb-sm-0">
                          <li class="page-item" [class.disabled]="page === 1">
                              <a class="page-link" (click)="goToPage(page - 1)" aria-label="Previous">
                                  <span aria-hidden="true"><i class="fas fa-chevron-left"></i></span>
                              </a>
                          </li>
                          <li class="page-item" *ngFor="let p of pages" [class.active]="p === page">
                              <a class="page-link" (click)="goToPage(p)">{{ p }}</a>
                          </li>
                          <li class="page-item" [class.disabled]="page === totalPages">
                              <a class="page-link" (click)="goToPage(page + 1)" aria-label="Next">
                                  <span aria-hidden="true"><i class="fas fa-chevron-right"></i></span>
                              </a>
                          </li>
                      </ul>
                  </div>
              </div>
          </div>
      </div>
      <!-- Contenido de la pestaña Evaluar -->
      <div class="tab-pane fade" [ngClass]="{'show active': activeTab === 2}">
        <div class="row align-items-center">
          <div class="col-md-6">
              <div class="mb-3">
                  <h4 class="card-title">Evaluación de Prospectos <span class="text-muted fw-normal ms-2"></span></h4>
              </div>
          </div>
        </div>
        <hr>
        <!-- Tabla de prospectos -->
        <div class="row">
          <div class="col-lg-12">
              <div class="table-responsive">
                  <table class="table project-list-table table-nowrap align-middle table-borderless table-hover">
                      <thead>
                          <tr>
                              <th scope="col">Nombre</th>
                              <th scope="col">Primer Apellido</th>
                              <th scope="col">Segundo Apellido</th>
                              <th scope="col">Número de Teléfono</th>
                              <th scope="col">Estatus</th>
                              <th scope="col" style="width: 200px;">Acciones</th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr *ngFor="let prospect of prospects">
                            <td>{{prospect?.name}}</td>
                            <td>{{prospect?.lastName}}</td>
                            <td>{{prospect?.secondLastName}}</td>
                            <td>{{prospect?.phoneNumber}}</td>
                            <td>
                              <span
                                  class="badge"
                                  [ngClass]="{
                                      'badge-soft-success': prospect?.status == 1,
                                      'badge-soft-danger': prospect?.status == 2,
                                      'badge-soft-primary': prospect?.status == 3
                                  }">
                                  {{getStatusString(prospect?.status)}}
                              </span>
                            </td>
                            <td>
                              <ul class="list-inline mb-0">
                                <li class="list-inline-item">
                                  <button (click)="authorizeProspect(prospect)" data-bs-toggle="tooltip" data-bs-placement="top" title="Autorizar" class="btn btn-sm btn-success" [class.disabled]="prospect?.status != 3">
                                    <i class="fas fa-check"></i>
                                  </button>
                                  &nbsp;
                                  <button (click)="openRejectModal(prospect)" data-bs-toggle="tooltip" data-bs-placement="top" title="Rechazar" class="btn btn-sm btn-danger" [class.disabled]="prospect?.status != 3">
                                    <i class="fas fa-ban"></i>
                                  </button>
                                  &nbsp;
                                  <button (click)="editProspect(prospect?.idProspect)" data-bs-toggle="tooltip" data-bs-placement="top" title="Detalle" class="btn btn-sm btn-primary">
                                    <i class="fas fa-eye"></i>
                                  </button>
                                </li>
                              </ul>
                            </td>
                        </tr>
                      </tbody>
                  </table>
              </div>
          </div>
      </div>

        <!-- Paginación -->
        <div class="row g-0 align-items-center pb-4">
            <!-- <div class="col-sm-6">
                <div>
                    <p class="mb-sm-0">{{(page - 1) * pageSize + 1}} - {{page * pageSize > total ? total : page * pageSize}} de {{total}}</p>
                </div>
            </div> -->
            <div class="col-sm-6">
                <div class="float-sm-end">
                    <ul class="pagination mb-sm-0">
                        <li class="page-item" [class.disabled]="page === 1">
                            <a class="page-link" (click)="goToPage(page - 1)" aria-label="Previous">
                                <span aria-hidden="true"><i class="fas fa-chevron-left"></i></span>
                            </a>
                        </li>
                        <li class="page-item" *ngFor="let p of pages" [class.active]="p === page">
                            <a class="page-link" (click)="goToPage(p)">{{ p }}</a>
                        </li>
                        <li class="page-item" [class.disabled]="page === totalPages">
                            <a class="page-link" (click)="goToPage(page + 1)" aria-label="Next">
                                <span aria-hidden="true"><i class="fas fa-chevron-right"></i></span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
      </div>
  </div>
</div>

<!-- Modal para comentarios de rechazo -->
<div class="modal fade" id="rejectNoteModal" tabindex="-1" aria-labelledby="rejectNoteModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="rejectNoteModalLabel">Rechazar Prospecto</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form #rejectForm="ngForm">
          <div class="mb-3">
            <label for="rejectNote" class="form-label">Comentario</label>
            <textarea class="form-control" id="rejectNote" [(ngModel)]="rejectNote" name="rejectNote" rows="3" required style="resize: none"></textarea>
          </div>
          <div *ngIf="commentError" class="text-danger">
            El comentario es obligatorio.
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-danger" (click)="confirmRejection()">Rechazar</button>
      </div>
    </div>
  </div>
</div>

<!-- jQuery & Bootstrap -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/5.3.45/css/materialdesignicons.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
